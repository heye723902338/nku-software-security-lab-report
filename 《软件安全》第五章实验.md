# 《软件安全》第五章实验

**姓名：何叶  学号:2313487  班级：范玲玲班**

## 实验名称：shellcode编码解码及提取shellcode代码

## 一、实验要求

复现第五章实验三，并将产生的编码后的shellcode在示例5-4中进行验证，阐述shellcode编码的原理、shellcode提取的思想。

## 二、实验过程

### 1、提取

#### 1.1先写C程序，打断点

![image-20250414202019308](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414202019308.png)

#### 1.2反汇编获取代码

![image-20250414201807555](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414201807555.png)

#### 1.3通过_asm写汇编代码

![image-20250414202301462](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414202301462.png)

#### 1.4删掉MessageBox,再调试

![image-20250414202459989](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414202459989.png)

#### 1.5打断点。进入反汇编

![image-20250414202627548](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414202627548.png)

#### 1.6复制地址跳转00401028

![image-20250414202734179](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414202734179.png)

#### 1.7找到所需代码

![image-20250414202831694](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414202831694.png)

#### 1.8新建文本储存

![image-20250414202929009](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414202929009.png)

#### 1.9空格替换为\x

![image-20250414203054482](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414203054482.png)

#### 1.10在示例5-4验证

![image-20250414203433918](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414203433918.png)

### 2.编写

#### 2.1编写hello world

![image-20250414205020942](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414205020942.png)

#### 2.2进入反汇编

![image-20250414204502671](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414204502671.png)

#### 2.3跳转至0040103C

![image-20250414204658116](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414204658116.png)

#### 2.4得到机器码

![image-20250414204853768](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414204853768.png)

![image-20250414204928080](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414204928080.png)

### 3.编码

#### 3.1用xor编码

![image-20250414205305505](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414205305505.png)

#### 3.2运行后输出

![image-20250414205353367](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414205353367.png)

#### 3.3生成encode文件

![image-20250414205730828](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414205730828.png)

![image-20250414205826450](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414205826450.png)

### 4.解码

#### 4.1解码程序

![image-20250414210201028](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414210201028.png)

#### 4.2反汇编看call lable

![image-20250414210525054](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414210525054.png)

#### 4.3运行lable得到地址

![image-20250414210929053](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414210929053.png)

#### 4.4提取机器码

![image-20250414211504045](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414211504045.png)

#### 4.5加encode组成完整shellcode

![image-20250414211609004](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414211609004.png)

#### 4.6放入万能验证程序验证

![image-20250414211724082](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414211724082.png)

#### 4.6验证成功

![image-20250414211750473](C:\Users\he'ye\Desktop\《软件安全》第五章实验.assets\image-20250414211750473.png)

## 三、心得体会

### 1.Shellcode编码原理

Shellcode编码是一种将恶意代码转换成另一种形式以规避安全机制的技术。其原理是通过改变代码的字节序列，使其在功能不变的情况下，外观与原始代码不同，从而绕过入侵检测系统。常见的编码技术包括十六进制、八进制、Base64编码，或利用特殊字符和转义序列。

### 2.Shellcode提取的思想

Shellcode提取是从编码数据中恢复原始shellcode的过程。这通常涉及字符串解析、模式匹配和解码算法，需要识别并解码编码技术，将shellcode还原成可读形式。在网络安全领域，Shellcode编码和提取技术使攻击者能更隐蔽地执行恶意操作，但也推动了安全社区开发更先进的检测和防御技术。
