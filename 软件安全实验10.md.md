# 软件安全实验10

### 姓名：何叶   学号：2313487   班级：范玲玲班

[TOC]

## 实验名称：WEB开发

## 实验要求：

  复现课本第十章的实验三(10.3.5节)：利用php，编写简单的数据库插入、查询和删除操作的示例。

基于课本的完整的例子，进一步了解WEB开发的细节

## 实验原理：

  本实验主要通过使用PHP语言结合MySQL数据库，实现一个简单的Web应用程序，完成用户登录、新闻添加、查询和删除等功能。实验的核心在于PHP与MySQL的交互，通过PHP的  mysql_connect  、  mysql_db_query  等函数，实现与MySQL数据库的连接、查询和操作。同时，利用HTML表单将用户输入的数据提交到PHP脚本进行处理，例如登录表单提交用户名和密码，新闻添加表单提交新闻标题和内容。根据用户输入和操作需求，构造相应的SQL语句（如  SELECT  、  INSERT  、  DELETE  ），并通过PHP执行这些语句来完成数据库操作。此外，实验还涉及Web页面的动态生成，根据数据库查询结果动态生成HTML页面内容，例如显示新闻列表或新闻详情。

## 实验步骤：

### 一、安装Dreamweaver 8

#### 1.解压缩后通过共享文件夹传入XP虚拟机

![image-20250520145328887](C:\Users\he'ye\AppData\Roaming\Typora\typora-user-images\image-20250520145328887.png)

#### 2.安装Dreamweaver 8

![image-20250520145734308](C:\Users\he'ye\AppData\Roaming\Typora\typora-user-images\image-20250520145734308.png)

#### 3.成功安装

![](C:\Users\he'ye\AppData\Roaming\Typora\typora-user-images\image-20250520150032385.png)

#### 4.打开Dreamweaver 8软件

![image-20250520150232684](C:\Users\he'ye\AppData\Roaming\Typora\typora-user-images\image-20250520150232684.png)

### 二、安装PHPnow

#### 1.setup.exe初始化

![image-20250520151826160](C:\Users\he'ye\AppData\Roaming\Typora\typora-user-images\image-20250520151826160.png)

#### 2.解压PHPnow

![image-20250520151618515](C:\Users\he'ye\AppData\Roaming\Typora\typora-user-images\image-20250520151618515.png)

#### 3.初始化失败

![image-20250520152352207](C:\Users\he'ye\AppData\Roaming\Typora\typora-user-images\image-20250520152352207.png)

#### 4.找到cmd.exe

![image-20250520163607581](C:\Users\he'ye\AppData\Roaming\Typora\typora-user-images\image-20250520163607581.png)

#### 5.在桌面创建快捷方式

![image-20250520163652705](C:\Users\he'ye\AppData\Roaming\Typora\typora-user-images\image-20250520163652705.png)

#### 6.cmd安装依然失败，选择在win11装

![image-20250520205713344](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520205713344.png)

#### 7.管理员进入初始化

![image-20250520205649322](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520205649322.png)

#### 8.设置root密码为123456

![image-20250520205808133](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520205808133.png)

#### 9.进入PHP默认界面

![image-20250520210023135](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520210023135.png)

![image-20250520210054938](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520210054938.png)

#### 10.默认资源index.php

![image-20250520210209470](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520210209470.png)

#### 11.MYSQL连接正确

![image-20250520211340629](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520211340629.png)

#### 12.进入phpMyAdmin

![image-20250520211614241](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520211614241.png)

#### 13.输入用户名和密码

![image-20250520211751876](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520211751876.png)

#### 14.创建数据库 testDB 成功

![image-20250520211826729](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520211826729.png)

#### 15.新建userinfo，添加值username，pwd

![image-20250520212053476](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520212053476.png)

#### 16.得到表

![image-20250520212145337](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520212145337.png)

#### 17.插入admin

![image-20250520212233700](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520212233700.png)

![image-20250520212251404](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520212251404.png)

### 三、编写示例

#### 1.打开Dreamweaver8新建html

![image-20250520213603767](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520213603767.png)

#### 2.编写login.html

![image-20250520213840397](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520213840397.png)

```html
<html>  
<body>  
<form id="form1" name="form1" method="post" action="loginok.php">  
 <table width="900" border="0" cellspacing="0" cellpadding="0">  
 <tr>  
 <td height="20">姓名</td>  
 <td height="20"><label>  
 <input name="username" type="text" id="username" />  
 </label></td>  
 </tr>  
 <tr>  
 <td height="20">口令</td>  
 <td height="20"><label>  
 <input name="pwd" type="password" id="pwd" />  
 </label></td>  
 </tr>  
 <tr>  
 <td height="20"> </td>  
 <td height="20"><label>  
 <input type="submit" name="Submit" value="提交" />  
 </label></td>  
 </tr>  
 </table>  
</form>  
</body>  
</html>  
```

#### 3.进入[127.0.0.1/login.html](http://127.0.0.1/login.html)

![image-20250520214030827](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520214030827.png)

#### 4.新建loginok.php

![image-20250520214550805](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520214550805.png)

#### 5.打开loginok.php

![image-20250520214634758](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520214634758.png)

#### 6.写loginok.php

```php
<?php
 $loginok=0;
 $conn=mysql_connect("localhost", "root", "123456"); 
 $username = $_POST['username'];
 $pwd = $_POST['pwd'];
 $SQLStr = "SELECT * FROM userinfo where username='$username' and password='$pwd'"; 
 echo $SQLStr;
 $result=mysql_db_query("testDB", $SQLStr, $conn); 
 if ($row=mysql_fetch_array($result))//通过循环读取数据内容 
 {
 $loginok=1;
 }
 // 释放资源
 mysql_free_result($result);
 // 关闭连接
 mysql_close($conn); 
 if ($loginok==1)
 {
 ?>
 <script> 
 alert("login succes");
 window.location.href="sys.php"; 
 </script>
 <?php
 }
 else{
 ?>
 <script> 
 alert("login failed");
 history.back(); 
 </script>
 <?php
 }
 
?>
```

#### 7.如果输入错误

![image-20250520215246098](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250520215246098.png)

#### 8.输入正确

![image-20250521081940580](C:\Users\he'ye\Desktop\image-20250521081940580.png)

#### 9.写sys.php

![image-20250521082126774](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250521082126774.png)

```html
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>主页</title>
</head>
<?php
$conn=mysql_connect("localhost", "root", "123456"); 
?>
<body>
<div align="center">
 <table width="900" border="0" cellspacing="0" cellpadding="0">
 <tr>
 <td height="40"><form id="form1" name="form1" method="post" action="add.php">
 <div align="right">新闻标题：
 <input name="topic" type="text" id="topic" size="50" />
 <BR>
 新闻内容：
 <textarea name="content" cols="60" rows="8" id="content"></textarea><BR>
 <input type="submit" name="Submit" value="添加" />
 </div>
 </form>
 </td>
 </tr>
 <tr>
 <td><hr /></td>
 </tr>
 <tr>
 <td height="300" align="center" valign="top"><table width="600" border="0" cellspacing="0" 
cellpadding="0">
 <tr>
 <td width="100" height="30"><div align="center">新闻序号</div></td>
 <td><div align="center">新闻标题</div></td>
 <td><div align="center">删除</div></td>
 </tr>
<?php 
 $SQLStr = "select * from news";
 $result=mysql_db_query("testDB", $SQLStr, $conn); 
 if ($row=mysql_fetch_array($result))//通过循环读取数据内容 
 { 
 // 定位到第一条记录
 mysql_data_seek($result, 0);
 // 循环取出记录
 while ($row=mysql_fetch_row($result))
 { 
?> 
<tr>
<td height="30"><div align="center"> <?php echo $row[0] ?> </div></td>
 <td width="400"> <div align="center"> <?php echo $row[1] ?> </div></td>
 <td><div align="center"><a href="del.php?newsid=<?php echo $row[0] ?> " > 删 除 </a> 
</div></td>
 </tr>
<?php 
 }
 }
?>
 </table></td>
 </tr>
 </table>
</div>
</body>
</html>
<?php 
 // 释放资源
 mysql_free_result($result);
 // 关闭连接
 mysql_close($conn); 
?>
```

#### 10.写数据库表news

![image-20250521090552414](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.md.assets\image-20250521090552414.png)

#### 11.写add.php用于增加新闻

![image-20250521082310923](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250521082310923.png)

```html
<?php 
 $conn=mysql_connect("localhost", "root", "123456"); 
 mysql_select_db("TestDB"); 
 $topic = $_POST['topic'];
 $content = $_POST['content'];
 $SQLStr = "insert into news(topic, content) values('$topic', '$content')"; 
 echo $SQLStr; 
 $result=mysql_query($SQLStr);
 
 // 关闭连接
 mysql_close($conn); 
 if ($result)
 {
 ?>
<script> 
 alert("insert succes");
 window.location.href="sys.php"; 
 </script>
 <?php
 }
 else{
 ?>
 <script> 
 alert("insert failed");
 history.back(); 
 </script>
 <?php
 }
 
?>
```

#### 12.新闻界面

![image-20250521082432173](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250521082432173.png)

#### 13.写del.php用于删除新闻

![image-20250521082648296](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250521082648296.png)

```html
<?php 
 $conn=mysql_connect("localhost", "root", "123456"); 
 mysql_select_db("TestDB"); 
 $newsid = $_GET['newsid']; 
 $SQLStr = "delete from news where newsid=$newsid"; 
 echo $SQLStr;
 $result=mysql_query($SQLStr); 
 // 关闭连接
 mysql_close($conn); 
 if ($result)
 {
 ?>
 <script> 
 alert("delete succes");
 window.location.href="sys.php"; 
 </script>
 <?php
}
 else{
 ?>
 <script> 
 alert("delete failed");
 history.back(); 
 </script>
 <?php
 } 
?>
```

#### 14.写index.php用于查看新闻

![image-20250521083127297](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250521083127297.png)

![image-20250521084533620](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250521084533620.png)

```html
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>主页</title>
</head>
<?php
$conn=mysql_connect("localhost", "root", "123456");
?>
<body>
<div align="center">
<table width="900" border="0" cellspacing="0" cellpadding="0">
<tr>
<td height="40"><form id="form1" name="form1" method="post" action="loginok.php">
<div align="right">用户名：
<input name="username" type="text" id="username" size="12" /> 密码：
<input name="pwd" type="password" id="pwd" size="12" />
<input type="submit" name="Submit" value="提交" />
</div>
</form>
</td>
</tr>
<tr>
<td><hr /></td>
</tr>
<tr>
<td height="300" align="center" valign="top"><table width="600" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="100" height="30"><div align="center">新闻序号</div></td>
<td><div align="center">新闻标题</div></td>
</tr>
<?php
$SQLStr = "select * from news";
$result=mysql_db_query("testDB", $SQLStr, $conn);
if ($row=mysql_fetch_array($result))//通过循环读取数据内容
{
// 定位到第一条记录
mysql_data_seek($result, 0);
// 循环取出记录
while ($row=mysql_fetch_row($result))
{
?>
<tr>
<td height="30"><div align="center"> <?php echo $row[0] ?> </div></td>
<td> <div align="center"> <a href="news.php?newsid=<?php echo $row[0] ?> " > <?php echo
$row[1] ?> </a> </div></td>
</tr>
<?php
}
}
?>
</table></td>
</tr>
</table>
</div>
</body>
</html>
<?php
// 释放资源
mysql_free_result($result);
// 关闭连接
mysql_close($conn);
?>
```

#### 15.写news.php点击

![image-20250521083239959](C:\Users\he'ye\Desktop\软件安全作业\软件安全实验10.assets\image-20250521083239959.png)

```html
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>主页</title>
</head>
<body>
<div align="center">
<table width="900" border="0" cellspacing="0" cellpadding="0">
<tr>
<td height="40"><form id="form1" name="form1" method="post" action="loginok.php">
<div align="right">用户名：
<input name="username" type="text" id="username" size="12" /> 密码：
<input name="password" type="password" id="password" size="12" />
<input type="submit" name="Submit" value="提交" />
</div>
</form>
</td>
</tr>
<tr>
<td><hr /></td>
</tr>
<tr>
<td height="300" align="center" valign="top"><p>&nbsp;</p>
<?php
$conn=mysql_connect("localhost", "root", "123456");
$newsid = $_GET['newsid'];
$SQLStr = "select * from news where newsid=$newsid";
$result=mysql_db_query("testDB", $SQLStr, $conn);
if ($row=mysql_fetch_array($result))//通过循环读取数据内容
{
// 定位到第一条记录
mysql_data_seek($result, 0);
// 循环取出记录
while ($row=mysql_fetch_row($result))
{
echo "$row[1]<br>"; echo "$row[2]<br>";
}
}
// 释放资源
mysql_free_result($result);
// 关闭连接
mysql_close($conn);
?>
</td>
</tr>
</table>
</div>
</body>
</html>
```

## 心得体会：

通过本次实验，我深入理解了PHP与MySQL结合进行Web开发的基本流程和方法。实验过程中，我学会了如何搭建开发环境，包括安装Dreamweaver和PHPnow，并成功创建了数据库和表。在编写代码时，我体会到了SQL注入问题的潜在风险，尤其是在构造SQL语句时，直接将用户输入拼接到SQL语句中可能会导致安全漏洞。未来，我将学习如何使用参数化查询等更安全的方法来避免此类问题。此外，通过实际操作，我对Web开发中的表单处理、页面跳转和动态内容生成有了更直观的认识，为后续学习更复杂的Web开发技术奠定了基础。

